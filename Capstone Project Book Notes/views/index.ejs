<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>The Book Chronicles - Literary Reviews & Notes</title>
    <link rel="stylesheet" href="/styles/main.css" />
</head>
<body>
    <nav class="navbar">
        <div class="navbar-container">
            <div class="logo">üìö The Book Chronicles</div>
            <a href="/new" class="btn btn-primary btn-sm">+ Write a Review</a>
        </div>
    </nav>

    <header class="hero-header">
        <div class="hero-content">
            <h1>The Book Chronicles</h1>
            <p class="hero-subtitle">Exploring the world through literature, one book at a time</p>
            <div class="hero-stats">
                <div class="stat-item">
                    <span class="stat-number"><%= totalBooks %></span>
                    <span class="stat-label">Books Read</span>
                </div>
            </div>
        </div>
    </header>

    <div class="container">
        <div class="controls-bar">
            <div class="sort-filter">
                <span class="filter-label">Sort by:</span>
                <div class="sort-buttons">
                    <a
                        href="/?sort=rating"
                        class="sort-btn <%= currentSort === 'rating' ? 'active' : '' %>"
                    >
                        Rating
                    </a>
                    <a
                        href="/?sort=date"
                        class="sort-btn <%= currentSort === 'date' ? 'active' : '' %>"
                    >
                        Recently Read
                    </a>
                    <a
                        href="/?sort=title"
                        class="sort-btn <%= currentSort === 'title' ? 'active' : '' %>"
                    >
                        Title
                    </a>
                </div>
            </div>
        </div>

        <% if (books.length === 0) { %>
            <div class="empty-state">
                <div class="empty-icon">üìö</div>
                <h2>Start Your Literary Journey</h2>
                <p>No books in your collection yet. Begin by adding your first book review.</p>
                <a href="/new" class="btn btn-primary btn-lg">Write Your First Review</a>
            </div>
        <% } else { %>
            <div class="articles-list">
                <% books.forEach((book, index) => { %>
                    <article class="book-article">
                        <div class="article-content">
                            <div class="article-header">
                                <a href="/books/<%= book.id %>" class="article-title-link">
                                    <h2 class="article-title"><%= book.title %></h2>
                                </a>
                                <p class="article-author">by <strong><%= book.author %></strong></p>
                            </div>

                            <div class="article-meta">
                                <% if (book.rating) { %>
                                    <div class="meta-item rating-badge">
                                        <% for (let i = 1; i <= 5; i++) { %>
                                            <span class="star <%= i <= book.rating ? 'filled' : '' %>">‚òÖ</span>
                                        <% } %>
                                        <span class="rating-text"><%= book.rating %>/5</span>
                                    </div>
                                <% } %>
                                <% if (book.date_read) { %>
                                    <div class="meta-item date-badge">
                                        <span class="read-date">
                                            <%= new Date(book.date_read).toLocaleDateString('en-US', {
                                                year: 'numeric',
                                                month: 'short',
                                                day: 'numeric'
                                            }) %>
                                        </span>
                                    </div>
                                <% } %>
                            </div>

                            <% if (book.notes) { %>
                                <div class="article-excerpt">
                                    <p>
                                        <%= book.notes.length > 200
                                            ? book.notes.substring(0, 200) + '...'
                                            : book.notes
                                        %>
                                    </p>
                                </div>
                            <% } %>

                            <div class="article-footer">
                                <a href="/books/<%= book.id %>" class="read-more">Read Full Review</a>
                                <div class="article-actions">
                                    <a href="/edit/<%= book.id %>" class="btn-icon btn-edit-icon" title="Edit review">
                                        ‚úèÔ∏è
                                    </a>
                                    <form
                                        action="/books/<%= book.id %>/delete"
                                        method="POST"
                                        style="display: inline;"
                                    >
                                        <button class="btn-icon btn-delete-icon" title="Delete review">
                                            üóëÔ∏è
                                        </button>
                                    </form>
                                </div>
                            </div>
                        </div>

                        <% if (book.coverUrl || !book.isbn) { %>
                            <div class="article-cover">
                                <% if (book.isbn && book.coverUrl) { %>
                                    <img src="<%= book.coverUrl %>" alt="<%= book.title %> cover" />
                                <% } else { %>
                                    <div class="no-cover-article">
                                        <span>üìñ</span>
                                    </div>
                                <% } %>
                            </div>
                        <% } %>
                    </article>
                <% }); %>
            </div>
        <% } %>
    </div>
    <footer class="footer">
            <div class="footer-content">
                <p>The Book Chronicles ¬© 2024 | Built for book enthusiasts</p>
                <p>
                    <a href="https://openlibrary.org" target="_blank" rel="noopener noreferrer">
                        Powered by Open Library
                    </a>
                </p>
            </div>
        </footer>
</body>
</html>
